# FIR滤波器音频均衡器

## 功能概述

本程序实现了一个基于FIR滤波器的5频段音频均衡器，可以对不同频率的声音应用不同的增益，实现多种音效。

## 技术特点

1. **FIR滤波器设计**：使用窗函数法设计FIR滤波器，采用汉明窗
2. **5频段均衡**：
   - Bass (60-250 Hz): 低音频段
   - Low-Mid (250-500 Hz): 低中音频段  
   - Mid (500-2000 Hz): 中音频段
   - High-Mid (2000-4000 Hz): 高中音频段
   - Treble (4000-16000 Hz): 高音频段

3. **滤波器类型**：
   - 低音：低通滤波器 (250Hz截止)
   - 高音：高通滤波器 (4000Hz截止)
   - 中频：带通滤波器

4. **实时处理**：在音频播放过程中实时处理16位PCM音频数据

## 预设模式

- **0 - Flat**: 平衡模式，所有频段增益为0
- **1 - Bass Boost**: 低音增强 (+6dB低音)
- **2 - Treble Boost**: 高音增强 (+6dB高音)
- **3 - Vocal**: 人声增强 (+4dB中频)
- **4 - Classical**: 古典音乐 (低音+高音增强)
- **5 - Rock**: 摇滚音乐 (V型曲线)
- **6 - Pop**: 流行音乐 (低音+高音适度增强)

## 操作说明

### 基本控制
- `q`: 退出程序
- `p`: 暂停/继续播放
- `n`: 下一首曲目
- `b`: 上一首曲目
- `f`: 快进10秒
- `r`: 快退10秒
- `左/右方向键`: 调节音量

### 均衡器控制
- `e`: 开启/关闭均衡器
- `0-6`: 切换均衡器预设模式

### 手动调节频段
- `z/Z`: 增加/减少低音增益
- `x/X`: 增加/减少低中音增益  
- `c/C`: 增加/减少中音增益
- `v/V`: 增加/减少高中音增益
- `g/G`: 增加/减少高音增益

## 使用示例

```bash
# 播放目录下所有wav文件并启用均衡器
./music_app -m /path/to/music/

# 运行时操作：
# 1. 按 'e' 开启均衡器
# 2. 按 '1' 切换到低音增强模式
# 3. 按 'z' 进一步增强低音
# 4. 按 '2' 切换到高音增强模式
```

## 技术实现细节

### FIR滤波器设计
- 滤波器阶数：64
- 窗函数：汉明窗
- 延迟线：每个滤波器维护65个样本的延迟线

### 音频处理流程
1. 读取WAV文件的PCM数据
2. 将16位整数转换为双精度浮点数 (-1.0 到 1.0)
3. 每个频段并行处理音频样本
4. 各频段输出叠加
5. 限幅处理防止溢出
6. 转换回16位整数输出到声卡

### 性能优化
- 使用固定点运算优化（可选）
- 并行处理多个频段
- 内存预分配避免动态分配

## 注意事项

1. 当前版本仅支持16位PCM音频文件
2. 均衡器处理会增加一定的CPU负载
3. 过度增益可能导致音频失真，建议增益控制在±12dB以内
4. 需要安装ALSA库和数学库 (`libasound2-dev`, `libm`)

## 编译要求

```bash
# 安装依赖
sudo apt-get install libasound2-dev

# 编译
make clean && make
``` 